{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Projects\\\\Reactivities\\\\client-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Projects\\\\Reactivities\\\\client-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _initializerDefineProperty from\"C:\\\\Projects\\\\Reactivities\\\\client-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/initializerDefineProperty\";import _classCallCheck from\"C:\\\\Projects\\\\Reactivities\\\\client-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Projects\\\\Reactivities\\\\client-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _applyDecoratedDescriptor from\"C:\\\\Projects\\\\Reactivities\\\\client-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/applyDecoratedDescriptor\";import _initializerWarningHelper from\"C:\\\\Projects\\\\Reactivities\\\\client-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/initializerWarningHelper\";var _class,_descriptor,_descriptor2,_descriptor3,_descriptor4,_descriptor5,_temp;import{observable,computed,action,runInAction}from'mobx';import agent from'../api/agent';import{history}from'../..';var UserStore=(_class=(_temp=/*#__PURE__*/function(){function UserStore(rootStore){_classCallCheck(this,UserStore);this.rootStore=void 0;_initializerDefineProperty(this,\"user\",_descriptor,this);_initializerDefineProperty(this,\"login\",_descriptor2,this);_initializerDefineProperty(this,\"register\",_descriptor3,this);_initializerDefineProperty(this,\"getUser\",_descriptor4,this);_initializerDefineProperty(this,\"logout\",_descriptor5,this);this.rootStore=rootStore;}_createClass(UserStore,[{key:\"isLoggedIn\",get:function get(){return!!this.user;}}]);return UserStore;}(),_temp),(_descriptor=_applyDecoratedDescriptor(_class.prototype,\"user\",[observable],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){return null;}}),_applyDecoratedDescriptor(_class.prototype,\"isLoggedIn\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"isLoggedIn\"),_class.prototype),_descriptor2=_applyDecoratedDescriptor(_class.prototype,\"login\",[action],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){var _this=this;return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return agent.User.login(values);case 3:user=_context.sent;runInAction(function(){_this.user=user;});_this.rootStore.commonStore.setToken(user.token);_this.rootStore.modalStore.closeModal();history.push('/activities');_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);throw _context.t0;case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();}}),_descriptor3=_applyDecoratedDescriptor(_class.prototype,\"register\",[action],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){var _this2=this;return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return agent.User.register(values);case 3:user=_context2.sent;_this2.rootStore.commonStore.setToken(user.token);_this2.rootStore.modalStore.closeModal();history.push('/activities');_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);throw _context2.t0;case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();}}),_descriptor4=_applyDecoratedDescriptor(_class.prototype,\"getUser\",[action],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){var _this3=this;return/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var user;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return agent.User.current();case 3:user=_context3.sent;runInAction(function(){_this3.user=user;});_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));}}),_descriptor5=_applyDecoratedDescriptor(_class.prototype,\"logout\",[action],{configurable:true,enumerable:true,writable:true,initializer:function initializer(){var _this4=this;return function(){_this4.rootStore.commonStore.setToken(null);_this4.user=null;history.push('/');};}})),_class);export{UserStore as default};","map":{"version":3,"sources":["C:/Projects/Reactivities/client-app/src/app/stores/userStore.ts"],"names":["observable","computed","action","runInAction","agent","history","UserStore","rootStore","user","values","User","login","commonStore","setToken","token","modalStore","closeModal","push","register","current","console","log"],"mappings":"8vCAAA,OAASA,UAAT,CAAqBC,QAArB,CAA+BC,MAA/B,CAAuCC,WAAvC,KAA0D,MAA1D,CAEA,MAAOC,CAAAA,KAAP,KAAkB,cAAlB,CAEA,OAASC,OAAT,KAAwB,OAAxB,C,GAEqBC,CAAAA,S,wCAEnB,mBAAYC,SAAZ,CAAkC,sCADlCA,SACkC,mTAChC,KAAKA,SAAL,CAAiBA,SAAjB,CACD,C,4DAI0B,CACzB,MAAO,CAAC,CAAC,KAAKC,IAAd,CACD,C,gGAJAR,U,4FAAgC,K,8DAEhCC,Q,oJAIAC,M,oMAAe,iBAAOO,MAAP,iKAEOL,CAAAA,KAAK,CAACM,IAAN,CAAWC,KAAX,CAAiBF,MAAjB,CAFP,QAEND,IAFM,eAGZL,WAAW,CAAC,UAAM,CAChB,KAAI,CAACK,IAAL,CAAYA,IAAZ,CACD,CAFU,CAAX,CAGA,KAAI,CAACD,SAAL,CAAeK,WAAf,CAA2BC,QAA3B,CAAoCL,IAAI,CAACM,KAAzC,EACA,KAAI,CAACP,SAAL,CAAeQ,UAAf,CAA0BC,UAA1B,GACAX,OAAO,CAACY,IAAR,CAAa,aAAb,EARY,wK,uIAcff,M,sMAAkB,kBAAOO,MAAP,uKAEIL,CAAAA,KAAK,CAACM,IAAN,CAAWQ,QAAX,CAAoBT,MAApB,CAFJ,QAETD,IAFS,gBAGf,MAAI,CAACD,SAAL,CAAeK,WAAf,CAA2BC,QAA3B,CAAoCL,IAAI,CAACM,KAAzC,EACA,MAAI,CAACP,SAAL,CAAeQ,UAAf,CAA0BC,UAA1B,GACAX,OAAO,CAACY,IAAR,CAAa,aAAb,EALe,4K,wIAWlBf,M,iLAAiB,yLAEKE,CAAAA,KAAK,CAACM,IAAN,CAAWS,OAAX,EAFL,QAERX,IAFQ,gBAGdL,WAAW,CAAC,UAAM,CAChB,MAAI,CAACK,IAAL,CAAYA,IAAZ,CACD,CAFU,CAAX,CAHc,mFAOdY,OAAO,CAACC,GAAR,eAPc,sE,yEAWjBnB,M,4GAAgB,WAAM,CACrB,MAAI,CAACK,SAAL,CAAeK,WAAf,CAA2BC,QAA3B,CAAoC,IAApC,EACA,MAAI,CAACL,IAAL,CAAY,IAAZ,CACAH,OAAO,CAACY,IAAR,CAAa,GAAb,EACD,C,qBApDkBX,S","sourcesContent":["import { observable, computed, action, runInAction } from 'mobx';\nimport { IUser, IUserFormValues } from '../models/user';\nimport agent from '../api/agent';\nimport { RootStore } from './rootStore';\nimport { history } from '../..';\n\nexport default class UserStore {\n  rootStore: RootStore;\n  constructor(rootStore: RootStore) {\n    this.rootStore = rootStore;\n  }\n\n  @observable user: IUser | null = null;\n\n  @computed get isLoggedIn() {\n    return !!this.user;\n  }\n\n  @action login = async (values: IUserFormValues) => {\n    try {\n      const user = await agent.User.login(values);\n      runInAction(() => {\n        this.user = user;\n      });\n      this.rootStore.commonStore.setToken(user.token);\n      this.rootStore.modalStore.closeModal();\n      history.push('/activities');\n    } catch (error) {\n      throw error;\n    }\n  };\n\n  @action register = async (values: IUserFormValues) => {\n    try {\n      const user = await agent.User.register(values);\n      this.rootStore.commonStore.setToken(user.token);\n      this.rootStore.modalStore.closeModal();\n      history.push('/activities')\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  @action getUser = async () => {\n    try {\n      const user = await agent.User.current();\n      runInAction(() => {\n        this.user = user;\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  @action logout = () => {\n    this.rootStore.commonStore.setToken(null);\n    this.user = null;\n    history.push('/');\n  };\n}\n"]},"metadata":{},"sourceType":"module"}