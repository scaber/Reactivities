{"ast":null,"code":"/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v22.1.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nimport { GridOptionsWrapper } from \"./gridOptionsWrapper\";\nimport { SelectionController } from \"./selectionController\";\nimport { ColumnApi } from \"./columnController/columnApi\";\nimport { ColumnController } from \"./columnController/columnController\";\nimport { RowRenderer } from \"./rendering/rowRenderer\";\nimport { HeaderRootComp } from \"./headerRendering/headerRootComp\";\nimport { FilterManager } from \"./filter/filterManager\";\nimport { ValueService } from \"./valueService/valueService\";\nimport { EventService } from \"./eventService\";\nimport { GridPanel } from \"./gridPanel/gridPanel\";\nimport { GridApi } from \"./gridApi\";\nimport { ColumnFactory } from \"./columnController/columnFactory\";\nimport { DisplayedGroupCreator } from \"./columnController/displayedGroupCreator\";\nimport { ExpressionService } from \"./valueService/expressionService\";\nimport { TemplateService } from \"./templateService\";\nimport { PopupService } from \"./widgets/popupService\";\nimport { Logger, LoggerFactory } from \"./logger\";\nimport { ColumnUtils } from \"./columnController/columnUtils\";\nimport { AutoWidthCalculator } from \"./rendering/autoWidthCalculator\";\nimport { HorizontalResizeService } from \"./headerRendering/horizontalResizeService\";\nimport { Context } from \"./context/context\";\nimport { GridCore } from \"./gridCore\";\nimport { StandardMenuFactory } from \"./headerRendering/standardMenu\";\nimport { DragAndDropService } from \"./dragAndDrop/dragAndDropService\";\nimport { DragService } from \"./dragAndDrop/dragService\";\nimport { SortController } from \"./sortController\";\nimport { FocusedCellController } from \"./focusedCellController\";\nimport { MouseEventService } from \"./gridPanel/mouseEventService\";\nimport { CellNavigationService } from \"./cellNavigationService\";\nimport { Events } from \"./events\";\nimport { CellRendererFactory } from \"./rendering/cellRendererFactory\";\nimport { ValueFormatterService } from \"./rendering/valueFormatterService\";\nimport { AgCheckbox } from \"./widgets/agCheckbox\";\nimport { AgRadioButton } from \"./widgets/agRadioButton\";\nimport { VanillaFrameworkOverrides } from \"./vanillaFrameworkOverrides\";\nimport { ScrollVisibleService } from \"./gridPanel/scrollVisibleService\";\nimport { StylingService } from \"./styling/stylingService\";\nimport { ColumnHoverService } from \"./rendering/columnHoverService\";\nimport { ColumnAnimationService } from \"./rendering/columnAnimationService\";\nimport { AutoGroupColService } from \"./columnController/autoGroupColService\";\nimport { PaginationProxy } from \"./pagination/paginationProxy\";\nimport { PaginationAutoPageSizeService } from \"./pagination/paginationAutoPageSizeService\";\nimport { Constants } from \"./constants\";\nimport { ValueCache } from \"./valueService/valueCache\";\nimport { ChangeDetectionService } from \"./valueService/changeDetectionService\";\nimport { AlignedGridsService } from \"./alignedGridsService\";\nimport { UserComponentFactory } from \"./components/framework/userComponentFactory\";\nimport { UserComponentRegistry } from \"./components/framework/userComponentRegistry\";\nimport { AgComponentUtils } from \"./components/framework/agComponentUtils\";\nimport { ComponentMetadataProvider } from \"./components/framework/componentMetadataProvider\";\nimport { Beans } from \"./rendering/beans\";\nimport { Environment } from \"./environment\";\nimport { AnimationFrameService } from \"./misc/animationFrameService\";\nimport { NavigationService } from \"./gridPanel/navigationService\";\nimport { MaxDivHeightScaler } from \"./rendering/maxDivHeightScaler\";\nimport { SelectableService } from \"./rowNodes/selectableService\";\nimport { AutoHeightCalculator } from \"./rendering/autoHeightCalculator\";\nimport { PaginationComp } from \"./pagination/paginationComp\";\nimport { ResizeObserverService } from \"./misc/resizeObserverService\";\nimport { TooltipManager } from \"./widgets/tooltipManager\";\nimport { OverlayWrapperComponent } from \"./rendering/overlays/overlayWrapperComponent\";\nimport { AgGroupComponent } from \"./widgets/agGroupComponent\";\nimport { AgDialog } from \"./widgets/agDialog\";\nimport { AgPanel } from \"./widgets/agPanel\";\nimport { AgInputTextField } from \"./widgets/agInputTextField\";\nimport { AgInputTextArea } from \"./widgets/agInputTextArea\";\nimport { AgSlider } from \"./widgets/agSlider\";\nimport { _ } from \"./utils\";\nimport { AgColorPicker } from \"./widgets/agColorPicker\";\nimport { AgInputNumberField } from \"./widgets/agInputNumberField\";\nimport { AgInputRange } from \"./widgets/agInputRange\";\nimport { AgSelect } from \"./widgets/agSelect\";\nimport { AgAngleSelect } from \"./widgets/agAngleSelect\";\nimport { AgToggleButton } from \"./widgets/agToggleButton\";\nimport { DetailRowCompCache } from \"./rendering/detailRowCompCache\";\nimport { RowPositionUtils } from \"./entities/rowPosition\";\nimport { CellPositionUtils } from \"./entities/cellPosition\";\nimport { PinnedRowModel } from \"./pinnedRowModel/pinnedRowModel\";\nimport { ModuleRegistry } from \"./modules/moduleRegistry\";\nimport { ModuleNames } from \"./modules/moduleNames\";\nimport { UndoRedoService } from \"./undoRedo/undoRedoService\";\n\nvar Grid =\n/** @class */\nfunction () {\n  function Grid(eGridDiv, gridOptions, params) {\n    if (!eGridDiv) {\n      console.error('ag-Grid: no div element provided to the grid');\n      return;\n    }\n\n    if (!gridOptions) {\n      console.error('ag-Grid: no gridOptions provided to the grid');\n      return;\n    }\n\n    var debug = !!gridOptions.debug;\n    this.gridOptions = gridOptions;\n    var registeredModules = this.getRegisteredModules(params);\n    var beanClasses = this.createBeansList(registeredModules);\n    var agStackComponents = this.createAgStackComponentsList(registeredModules);\n    var providedBeanInstances = this.createProvidedBeans(eGridDiv, params);\n\n    if (!beanClasses) {\n      return;\n    } // happens when no row model found\n\n\n    var contextParams = {\n      providedBeanInstances: providedBeanInstances,\n      beanClasses: beanClasses,\n      components: agStackComponents,\n      debug: debug\n    };\n    this.logger = new Logger('ag-Grid', function () {\n      return gridOptions.debug;\n    });\n    var contextLogger = new Logger('Context', function () {\n      return contextParams.debug;\n    });\n    this.context = new Context(contextParams, contextLogger);\n    this.registerModuleUserComponents(registeredModules);\n    var gridCore = new GridCore();\n    this.context.wireBean(gridCore);\n    this.setColumnsAndData();\n    this.dispatchGridReadyEvent(gridOptions);\n    var isEnterprise = ModuleRegistry.isRegistered(ModuleNames.EnterpriseCoreModule);\n    this.logger.log(\"initialised successfully, enterprise = \" + isEnterprise);\n  }\n\n  Grid.prototype.getRegisteredModules = function (params) {\n    var passedViaConstructor = params ? params.modules : null;\n    var registered = ModuleRegistry.getRegisteredModules();\n    var allModules = [];\n    var mapNames = {}; // adds to list and removes duplicates\n\n    function addModule(module) {\n      function addIndividualModule(module) {\n        if (!mapNames[module.moduleName]) {\n          mapNames[module.moduleName] = true;\n          allModules.push(module);\n          ModuleRegistry.register(module);\n        }\n      }\n\n      addIndividualModule(module);\n\n      if (module.dependantModules) {\n        module.dependantModules.forEach(addModule);\n      }\n    }\n\n    if (passedViaConstructor) {\n      passedViaConstructor.forEach(addModule);\n    }\n\n    if (registered) {\n      registered.forEach(addModule);\n    }\n\n    return allModules;\n  };\n\n  Grid.prototype.registerModuleUserComponents = function (registeredModules) {\n    var userComponentRegistry = this.context.getBean('userComponentRegistry');\n    var moduleUserComps = this.extractModuleEntity(registeredModules, function (module) {\n      return module.userComponents ? module.userComponents : [];\n    });\n    moduleUserComps.forEach(function (compMeta) {\n      userComponentRegistry.registerDefaultComponent(compMeta.componentName, compMeta.componentClass);\n    });\n  };\n\n  Grid.prototype.createProvidedBeans = function (eGridDiv, params) {\n    var frameworkOverrides = params ? params.frameworkOverrides : null;\n\n    if (_.missing(frameworkOverrides)) {\n      frameworkOverrides = new VanillaFrameworkOverrides();\n    }\n\n    var seed = {\n      gridOptions: this.gridOptions,\n      eGridDiv: eGridDiv,\n      $scope: params ? params.$scope : null,\n      $compile: params ? params.$compile : null,\n      quickFilterOnScope: params ? params.quickFilterOnScope : null,\n      globalEventListener: params ? params.globalEventListener : null,\n      frameworkOverrides: frameworkOverrides\n    };\n\n    if (params && params.providedBeanInstances) {\n      _.assign(seed, params.providedBeanInstances);\n    }\n\n    return seed;\n  };\n\n  Grid.prototype.createAgStackComponentsList = function (registeredModules) {\n    var components = [{\n      componentName: 'AgCheckbox',\n      componentClass: AgCheckbox\n    }, {\n      componentName: 'AgRadioButton',\n      componentClass: AgRadioButton\n    }, {\n      componentName: 'AgToggleButton',\n      componentClass: AgToggleButton\n    }, {\n      componentName: 'AgInputTextField',\n      componentClass: AgInputTextField\n    }, {\n      componentName: 'AgInputTextArea',\n      componentClass: AgInputTextArea\n    }, {\n      componentName: 'AgInputNumberField',\n      componentClass: AgInputNumberField\n    }, {\n      componentName: 'AgInputRange',\n      componentClass: AgInputRange\n    }, {\n      componentName: 'AgSelect',\n      componentClass: AgSelect\n    }, {\n      componentName: 'AgSlider',\n      componentClass: AgSlider\n    }, {\n      componentName: 'AgAngleSelect',\n      componentClass: AgAngleSelect\n    }, {\n      componentName: 'AgColorPicker',\n      componentClass: AgColorPicker\n    }, {\n      componentName: 'AgGridComp',\n      componentClass: GridPanel\n    }, {\n      componentName: 'AgHeaderRoot',\n      componentClass: HeaderRootComp\n    }, {\n      componentName: 'AgPagination',\n      componentClass: PaginationComp\n    }, {\n      componentName: 'AgOverlayWrapper',\n      componentClass: OverlayWrapperComponent\n    }, {\n      componentName: 'AgGroupComponent',\n      componentClass: AgGroupComponent\n    }, {\n      componentName: 'AgPanel',\n      componentClass: AgPanel\n    }, {\n      componentName: 'AgDialog',\n      componentClass: AgDialog\n    }];\n    var moduleAgStackComps = this.extractModuleEntity(registeredModules, function (module) {\n      return module.agStackComponents ? module.agStackComponents : [];\n    });\n    components = components.concat(moduleAgStackComps);\n    return components;\n  };\n\n  Grid.prototype.createBeansList = function (registeredModules) {\n    var rowModelClass = this.getRowModelClass(registeredModules);\n\n    if (!rowModelClass) {\n      return undefined;\n    } // beans should only contain SERVICES, it should NEVER contain COMPONENTS\n\n\n    var beans = [rowModelClass, Beans, RowPositionUtils, CellPositionUtils, PaginationAutoPageSizeService, GridApi, UserComponentRegistry, AgComponentUtils, ComponentMetadataProvider, ResizeObserverService, UserComponentFactory, MaxDivHeightScaler, AutoHeightCalculator, CellRendererFactory, HorizontalResizeService, PinnedRowModel, DragService, DisplayedGroupCreator, EventService, GridOptionsWrapper, PopupService, SelectionController, FilterManager, ColumnController, PaginationProxy, RowRenderer, ExpressionService, ColumnFactory, TemplateService, AlignedGridsService, NavigationService, ValueCache, ValueService, LoggerFactory, ColumnUtils, AutoWidthCalculator, StandardMenuFactory, DragAndDropService, ColumnApi, FocusedCellController, MouseEventService, Environment, CellNavigationService, ValueFormatterService, StylingService, ScrollVisibleService, SortController, ColumnHoverService, ColumnAnimationService, SelectableService, AutoGroupColService, ChangeDetectionService, AnimationFrameService, TooltipManager, DetailRowCompCache, UndoRedoService];\n    var moduleBeans = this.extractModuleEntity(registeredModules, function (module) {\n      return module.beans ? module.beans : [];\n    });\n    beans.push.apply(beans, moduleBeans); // check for duplicates, as different modules could include the same beans that\n    // they depend on, eg ClientSideRowModel in enterprise, and ClientSideRowModel in community\n\n    var beansNoDuplicates = [];\n    beans.forEach(function (bean) {\n      if (beansNoDuplicates.indexOf(bean) < 0) {\n        beansNoDuplicates.push(bean);\n      }\n    });\n    return beansNoDuplicates;\n  };\n\n  Grid.prototype.extractModuleEntity = function (moduleEntities, extractor) {\n    return [].concat.apply([], moduleEntities.map(extractor));\n  };\n\n  Grid.prototype.setColumnsAndData = function () {\n    var gridOptionsWrapper = this.context.getBean('gridOptionsWrapper');\n    var columnController = this.context.getBean('columnController');\n    var columnDefs = gridOptionsWrapper.getColumnDefs();\n\n    if (_.exists(columnDefs)) {\n      columnController.setColumnDefs(columnDefs, \"gridInitializing\");\n    }\n\n    var rowModel = this.context.getBean('rowModel');\n    rowModel.start();\n  };\n\n  Grid.prototype.dispatchGridReadyEvent = function (gridOptions) {\n    var eventService = this.context.getBean('eventService');\n    var readyEvent = {\n      type: Events.EVENT_GRID_READY,\n      api: gridOptions.api,\n      columnApi: gridOptions.columnApi\n    };\n    eventService.dispatchEvent(readyEvent);\n  };\n\n  Grid.prototype.getRowModelClass = function (registeredModules) {\n    var rowModelType = this.gridOptions.rowModelType; //TODO: temporary measure before 'enterprise' is completely removed (similar handling in gridOptionsWrapper is also required)\n\n    if (rowModelType === 'enterprise') {\n      console.warn(\"ag-Grid: enterprise rowModel deprecated. Should now be called server side row model instead.\");\n      rowModelType = Constants.ROW_MODEL_TYPE_SERVER_SIDE;\n    }\n\n    if (rowModelType === 'normal') {\n      console.warn(\"ag-Grid: normal rowModel deprecated. Should now be called client side row model instead.\");\n      rowModelType = Constants.ROW_MODEL_TYPE_CLIENT_SIDE;\n    } // default to client side\n\n\n    if (!rowModelType) {\n      rowModelType = Constants.ROW_MODEL_TYPE_CLIENT_SIDE;\n    }\n\n    var rowModelClasses = {};\n    registeredModules.forEach(function (module) {\n      _.iterateObject(module.rowModels, function (key, value) {\n        rowModelClasses[key] = value;\n      });\n    });\n    var rowModelClass = rowModelClasses[rowModelType];\n\n    if (_.exists(rowModelClass)) {\n      return rowModelClass;\n    } else {\n      if (rowModelType === Constants.ROW_MODEL_TYPE_INFINITE) {\n        console.error(\"ag-Grid: Row Model \\\"Infinite\\\" not found. Please ensure the \" + \"InfiniteRowModelModule is loaded using: import '@ag-grid-community/infinite-row-model';\");\n      }\n\n      console.error('ag-Grid: could not find matching row model for rowModelType ' + rowModelType);\n\n      if (rowModelType === Constants.ROW_MODEL_TYPE_VIEWPORT) {\n        console.error(\"ag-Grid: Row Model \\\"Viewport\\\" not found. For this row model to work you must \" + \"a) be using ag-Grid Enterprise and \" + \"b) ensure ViewportRowModelModule is \" + \"loaded using: import '@ag-grid-enterprise/viewport-row-model;\");\n      }\n\n      if (rowModelType === Constants.ROW_MODEL_TYPE_SERVER_SIDE) {\n        console.error(\"ag-Grid: Row Model \\\"Server Side\\\" not found. For this row model to work you must \" + \"a) be using ag-Grid Enterprise and \" + \"b) ensure ServerSideRowModelModule is \" + \"loaded using: import '@ag-grid-enterprise/server-server-side-row-model';\");\n      }\n\n      if (rowModelType === Constants.ROW_MODEL_TYPE_CLIENT_SIDE) {\n        console.error(\"ag-Grid: Row Model \\\"Client Side\\\" not found. Please ensure the \" + \"ClientSideRowModelModule is loaded using: import '@ag-grid-community/client-side-row-model';\");\n      }\n\n      return undefined;\n    }\n  };\n\n  Grid.prototype.destroy = function () {\n    this.gridOptions.api.destroy();\n  };\n\n  return Grid;\n}();\n\nexport { Grid };","map":null,"metadata":{},"sourceType":"module"}