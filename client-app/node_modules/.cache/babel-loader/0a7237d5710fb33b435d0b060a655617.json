{"ast":null,"code":"/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v22.1.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Component } from \"./component\";\nimport { Color, _ } from \"../utils\";\nimport { RefSelector } from \"./componentAnnotations\";\nimport { PostConstruct } from \"../context/context\";\n\nvar AgColorPanel =\n/** @class */\nfunction (_super) {\n  __extends(AgColorPanel, _super);\n\n  function AgColorPanel(config) {\n    var _this = _super.call(this, AgColorPanel.TEMPLATE) || this;\n\n    _this.H = 1; // in the [0, 1] range\n\n    _this.S = 1; // in the [0, 1] range\n\n    _this.B = 1; // in the [0, 1] range\n\n    _this.A = 1; // in the [0, 1] range\n\n    _this.isSpectrumDragging = false;\n    _this.isSpectrumHueDragging = false;\n    _this.isSpectrumAlphaDragging = false;\n    _this.colorChanged = false;\n    _this.picker = config.picker;\n    return _this;\n  }\n\n  AgColorPanel.prototype.postConstruct = function () {\n    var eGui = this.getGui();\n    this.initRecentColors();\n    this.addDestroyableEventListener(this.spectrumVal, 'mousedown', this.onSpectrumDraggerDown.bind(this));\n    this.addDestroyableEventListener(eGui, 'mousemove', this.onSpectrumDraggerMove.bind(this));\n    this.addDestroyableEventListener(this.spectrumHue, 'mousedown', this.onSpectrumHueDown.bind(this));\n    this.addDestroyableEventListener(eGui, 'mousemove', this.onSpectrumHueMove.bind(this));\n    this.addDestroyableEventListener(this.spectrumAlpha, 'mousedown', this.onSpectrumAlphaDown.bind(this));\n    this.addDestroyableEventListener(eGui, 'mousemove', this.onSpectrumAlphaMove.bind(this)); // Listening to `mouseup` on the document on purpose. The user might release the mouse button\n    // outside the UI control. When the mouse returns back to the control's area, the dragging\n    // of the thumb is not expected and seen as a bug.\n\n    this.addDestroyableEventListener(document, 'mouseup', this.onMouseUp.bind(this));\n    this.addDestroyableEventListener(this.recentColors, 'click', this.onRecentColorClick.bind(this));\n  };\n\n  AgColorPanel.prototype.refreshSpectrumRect = function () {\n    return this.spectrumValRect = this.spectrumVal.getBoundingClientRect();\n  };\n\n  AgColorPanel.prototype.refreshHueRect = function () {\n    return this.spectrumHueRect = this.spectrumHue.getBoundingClientRect();\n  };\n\n  AgColorPanel.prototype.refreshAlphaRect = function () {\n    return this.spectrumAlphaRect = this.spectrumAlpha.getBoundingClientRect();\n  };\n\n  AgColorPanel.prototype.onSpectrumDraggerDown = function (e) {\n    this.refreshSpectrumRect();\n    this.isSpectrumDragging = true;\n    this.moveDragger(e);\n  };\n\n  AgColorPanel.prototype.onSpectrumDraggerMove = function (e) {\n    if (this.isSpectrumDragging) {\n      this.moveDragger(e);\n    }\n  };\n\n  AgColorPanel.prototype.onSpectrumHueDown = function (e) {\n    this.refreshHueRect();\n    this.isSpectrumHueDragging = true;\n    this.moveHueSlider(e);\n  };\n\n  AgColorPanel.prototype.onSpectrumHueMove = function (e) {\n    if (this.isSpectrumHueDragging) {\n      this.moveHueSlider(e);\n    }\n  };\n\n  AgColorPanel.prototype.onSpectrumAlphaDown = function (e) {\n    this.refreshAlphaRect();\n    this.isSpectrumAlphaDragging = true;\n    this.moveAlphaSlider(e);\n  };\n\n  AgColorPanel.prototype.onSpectrumAlphaMove = function (e) {\n    if (this.isSpectrumAlphaDragging) {\n      this.moveAlphaSlider(e);\n    }\n  };\n\n  AgColorPanel.prototype.onMouseUp = function () {\n    this.isSpectrumDragging = false;\n    this.isSpectrumHueDragging = false;\n    this.isSpectrumAlphaDragging = false;\n  };\n\n  AgColorPanel.prototype.moveDragger = function (e) {\n    var valRect = this.spectrumValRect;\n\n    if (valRect) {\n      var x = e.clientX - valRect.left;\n      var y = e.clientY - valRect.top;\n      x = Math.max(x, 0);\n      x = Math.min(x, valRect.width);\n      y = Math.max(y, 0);\n      y = Math.min(y, valRect.height);\n      this.setSpectrumValue(x / valRect.width, 1 - y / valRect.height);\n    }\n  };\n\n  AgColorPanel.prototype.moveHueSlider = function (e) {\n    var hueRect = this.spectrumHueRect;\n\n    if (hueRect) {\n      var slider = this.spectrumHueSlider;\n      var sliderRect = slider.getBoundingClientRect();\n      var x = e.clientX - hueRect.left;\n      x = Math.max(x, 0);\n      x = Math.min(x, hueRect.width);\n      this.H = 1 - x / hueRect.width;\n      slider.style.left = x + sliderRect.width / 2 + 'px';\n      this.update();\n    }\n  };\n\n  AgColorPanel.prototype.moveAlphaSlider = function (e) {\n    var alphaRect = this.spectrumAlphaRect;\n\n    if (alphaRect) {\n      var slider = this.spectrumAlphaSlider;\n      var sliderRect = slider.getBoundingClientRect();\n      var x = e.clientX - alphaRect.left;\n      x = Math.max(x, 0);\n      x = Math.min(x, alphaRect.width);\n      this.A = x / alphaRect.width;\n      slider.style.left = x + sliderRect.width / 2 + 'px';\n      this.update();\n    }\n  };\n\n  AgColorPanel.prototype.update = function () {\n    var color = Color.fromHSB(this.H * 360, this.S, this.B, this.A);\n    var spectrumColor = Color.fromHSB(this.H * 360, 1, 1);\n    var rgbaColor = color.toRgbaString(); // the recent color list needs to know color has actually changed\n\n    var colorPicker = this.picker;\n    var existingColor = Color.fromString(colorPicker.getValue());\n\n    if (existingColor.toRgbaString() !== rgbaColor) {\n      this.colorChanged = true;\n    }\n\n    colorPicker.setValue(rgbaColor);\n    this.spectrumColor.style.backgroundColor = spectrumColor.toRgbaString();\n    this.spectrumDragger.style.backgroundColor = rgbaColor;\n  };\n  /**\n   * @param saturation In the [0, 1] interval.\n   * @param brightness In the [0, 1] interval.\n   */\n\n\n  AgColorPanel.prototype.setSpectrumValue = function (saturation, brightness) {\n    var valRect = this.spectrumValRect || this.refreshSpectrumRect();\n\n    if (valRect) {\n      var dragger = this.spectrumDragger;\n      var draggerRect = dragger.getBoundingClientRect();\n      saturation = Math.max(0, saturation);\n      saturation = Math.min(1, saturation);\n      brightness = Math.max(0, brightness);\n      brightness = Math.min(1, brightness);\n      this.S = saturation;\n      this.B = brightness;\n      dragger.style.left = saturation * valRect.width - draggerRect.width / 2 + 'px';\n      dragger.style.top = (1 - brightness) * valRect.height - draggerRect.height / 2 + 'px';\n      this.update();\n    }\n  };\n\n  AgColorPanel.prototype.initRecentColors = function () {\n    var recentColors = AgColorPanel.recentColors;\n    var innerHtml = recentColors.map(function (color, index) {\n      return \"<div class=\\\"ag-recent-color\\\" id=\" + index + \" style=\\\"background-color: \" + color + \"; width: 15px; height: 15px;\\\" recent-color=\\\"\" + color + \"\\\"></div>\";\n    });\n    this.recentColors.innerHTML = innerHtml.join('');\n  };\n\n  AgColorPanel.prototype.setValue = function (val) {\n    var color = Color.fromString(val);\n\n    var _a = color.toHSB(),\n        h = _a[0],\n        s = _a[1],\n        b = _a[2];\n\n    this.H = (isNaN(h) ? 0 : h) / 360;\n    this.A = color.a;\n    var spectrumHueRect = this.spectrumHueRect || this.refreshHueRect();\n    var spectrumAlphaRect = this.spectrumAlphaRect || this.refreshAlphaRect();\n    this.spectrumHueSlider.style.left = (this.H - 1) * -spectrumHueRect.width + \"px\";\n    this.spectrumAlphaSlider.style.left = this.A * spectrumAlphaRect.width + \"px\";\n    this.setSpectrumValue(s, b);\n  };\n\n  AgColorPanel.prototype.onRecentColorClick = function (e) {\n    var target = e.target;\n\n    if (!_.exists(target.id)) {\n      return;\n    }\n\n    var id = parseInt(target.id, 10);\n    this.setValue(AgColorPanel.recentColors[id]);\n    this.destroy();\n  };\n\n  AgColorPanel.prototype.addRecentColor = function () {\n    var color = Color.fromHSB(this.H * 360, this.S, this.B, this.A);\n    var rgbaColor = color.toRgbaString();\n    var recentColors = AgColorPanel.recentColors;\n\n    if (!this.colorChanged || recentColors[0] === rgbaColor) {\n      return;\n    } // remove duplicate color\n\n\n    recentColors = recentColors.filter(function (color) {\n      return color != rgbaColor;\n    }); // add color to head\n\n    recentColors = [rgbaColor].concat(recentColors); // ensure we don't exceed max number of recent colors\n\n    if (recentColors.length > AgColorPanel.maxRecentColors) {\n      recentColors = recentColors.slice(0, AgColorPanel.maxRecentColors);\n    }\n\n    AgColorPanel.recentColors = recentColors;\n  };\n\n  AgColorPanel.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this.addRecentColor();\n  };\n\n  AgColorPanel.maxRecentColors = 8;\n  AgColorPanel.recentColors = [];\n  AgColorPanel.TEMPLATE = \"<div class=\\\"ag-color-panel\\\">\\n            <div ref=\\\"spectrumColor\\\" class=\\\"ag-spectrum-color\\\">\\n                <div class=\\\"ag-spectrum-sat ag-fill\\\">\\n                    <div ref=\\\"spectrumVal\\\" class=\\\"ag-spectrum-val ag-fill\\\">\\n                        <div ref=\\\"spectrumDragger\\\" class=\\\"ag-spectrum-dragger\\\"></div>\\n                    </div>\\n                </div>\\n            </div>\\n            <div class=\\\"ag-spectrum-tools\\\">\\n                <div ref=\\\"spectrumHue\\\" class=\\\"ag-spectrum-hue ag-hue-alpha\\\">\\n                    <div class=\\\"ag-spectrum-hue-background\\\"></div>\\n                    <div ref=\\\"spectrumHueSlider\\\" class=\\\"ag-spectrum-slider\\\"></div>\\n                </div>\\n                <div ref=\\\"spectrumAlpha\\\" class=\\\"ag-spectrum-alpha ag-hue-alpha\\\">\\n                    <div class=\\\"ag-spectrum-alpha-background\\\"></div>\\n                    <div ref=\\\"spectrumAlphaSlider\\\" class=\\\"ag-spectrum-slider\\\"></div>\\n                </div>\\n                <div ref=\\\"recentColors\\\" class=\\\"ag-recent-colors\\\"></div>\\n            </div>\\n        </div>\";\n\n  __decorate([RefSelector('spectrumColor')], AgColorPanel.prototype, \"spectrumColor\", void 0);\n\n  __decorate([RefSelector('spectrumVal')], AgColorPanel.prototype, \"spectrumVal\", void 0);\n\n  __decorate([RefSelector('spectrumDragger')], AgColorPanel.prototype, \"spectrumDragger\", void 0);\n\n  __decorate([RefSelector('spectrumHue')], AgColorPanel.prototype, \"spectrumHue\", void 0);\n\n  __decorate([RefSelector('spectrumHueSlider')], AgColorPanel.prototype, \"spectrumHueSlider\", void 0);\n\n  __decorate([RefSelector('spectrumAlpha')], AgColorPanel.prototype, \"spectrumAlpha\", void 0);\n\n  __decorate([RefSelector('spectrumAlphaSlider')], AgColorPanel.prototype, \"spectrumAlphaSlider\", void 0);\n\n  __decorate([RefSelector('recentColors')], AgColorPanel.prototype, \"recentColors\", void 0);\n\n  __decorate([PostConstruct], AgColorPanel.prototype, \"postConstruct\", null);\n\n  return AgColorPanel;\n}(Component);\n\nexport { AgColorPanel };","map":null,"metadata":{},"sourceType":"module"}