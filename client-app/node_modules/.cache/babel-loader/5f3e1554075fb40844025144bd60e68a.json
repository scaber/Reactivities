{"ast":null,"code":"/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v22.1.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { PreConstruct } from \"../context/context\";\nimport { BeanStub } from \"../context/beanStub\";\nimport { _, NumberSequence } from \"../utils\";\nvar compIdSequence = new NumberSequence();\n\nvar Component =\n/** @class */\nfunction (_super) {\n  __extends(Component, _super);\n\n  function Component(template) {\n    var _this = _super.call(this) || this;\n\n    _this.childComponents = [];\n    _this.annotatedEventListeners = []; // if false, then CSS class \"ag-hidden\" is applied, which sets \"display: none\"\n\n    _this.displayed = true; // if false, then CSS class \"ag-invisible\" is applied, which sets \"visibility: hidden\"\n\n    _this.visible = true; // unique id for this row component. this is used for getting a reference to the HTML dom.\n    // we cannot use the RowNode id as this is not unique (due to animation, old rows can be lying\n    // around as we create a new rowComp instance for the same row node).\n\n    _this.compId = compIdSequence.next();\n\n    if (template) {\n      _this.setTemplate(template);\n    }\n\n    return _this;\n  }\n\n  Component.prototype.getCompId = function () {\n    return this.compId;\n  }; // for registered components only, eg creates AgCheckbox instance from ag-checkbox HTML tag\n\n\n  Component.prototype.createChildComponentsFromTags = function (parentNode) {\n    var _this = this; // we MUST take a copy of the list first, as the 'swapComponentForNode' adds comments into the DOM\n    // which messes up the traversal order of the children.\n\n\n    var childNodeList = _.copyNodeList(parentNode.childNodes);\n\n    childNodeList.forEach(function (childNode) {\n      var childComp = _this.getContext().createComponentFromElement(childNode, function (childComp) {\n        // copy over all attributes, including css classes, so any attributes user put on the tag\n        // wll be carried across\n        _this.copyAttributesFromNode(childNode, childComp.getGui());\n      });\n\n      if (childComp) {\n        if (childComp.addItems && childNode.children.length) {\n          _this.createChildComponentsFromTags(childNode); // converting from HTMLCollection to Array\n\n\n          var items = Array.prototype.slice.call(childNode.children);\n          childComp.addItems(items);\n        } // replace the tag (eg ag-checkbox) with the proper HTMLElement (eg 'div') in the dom\n\n\n        _this.swapComponentForNode(childComp, parentNode, childNode);\n      } else if (childNode.childNodes) {\n        _this.createChildComponentsFromTags(childNode);\n      }\n    });\n  };\n\n  Component.prototype.copyAttributesFromNode = function (source, dest) {\n    _.iterateNamedNodeMap(source.attributes, function (name, value) {\n      dest.setAttribute(name, value);\n    });\n  };\n\n  Component.prototype.swapComponentForNode = function (newComponent, parentNode, childNode) {\n    var eComponent = newComponent.getGui();\n    parentNode.replaceChild(eComponent, childNode);\n    parentNode.insertBefore(document.createComment(childNode.nodeName), eComponent);\n    this.childComponents.push(newComponent);\n    this.swapInComponentForQuerySelectors(newComponent, childNode);\n  };\n\n  Component.prototype.swapInComponentForQuerySelectors = function (newComponent, childNode) {\n    var thisProto = Object.getPrototypeOf(this);\n    var thisNoType = this;\n\n    while (thisProto != null) {\n      var metaData = thisProto.__agComponentMetaData;\n      var currentProtoName = thisProto.constructor.name;\n\n      if (metaData && metaData[currentProtoName] && metaData[currentProtoName].querySelectors) {\n        metaData[currentProtoName].querySelectors.forEach(function (querySelector) {\n          if (thisNoType[querySelector.attributeName] === childNode) {\n            thisNoType[querySelector.attributeName] = newComponent;\n          }\n        });\n      }\n\n      thisProto = Object.getPrototypeOf(thisProto);\n    }\n  };\n\n  Component.prototype.setTemplate = function (template) {\n    var eGui = _.loadTemplate(template);\n\n    this.setTemplateFromElement(eGui);\n  };\n\n  Component.prototype.setTemplateFromElement = function (element) {\n    this.eGui = element;\n    this.eGui.__agComponent = this;\n    this.addAnnotatedEventListeners();\n    this.wireQuerySelectors(); // context will not be available when user sets template in constructor\n\n    var contextIsAvailable = !!this.getContext();\n\n    if (contextIsAvailable) {\n      this.createChildComponentsFromTags(this.getGui());\n    }\n  };\n\n  Component.prototype.createChildComponentsPreConstruct = function () {\n    // ui exists if user sets template in constructor. when this happens, we have to wait for the context\n    // to be autoWired first before we can create child components.\n    var uiExists = !!this.getGui();\n\n    if (uiExists) {\n      this.createChildComponentsFromTags(this.getGui());\n    }\n  };\n\n  Component.prototype.wireQuerySelectors = function () {\n    var _this = this;\n\n    if (!this.eGui) {\n      return;\n    }\n\n    var thisProto = Object.getPrototypeOf(this);\n\n    var _loop_1 = function () {\n      var metaData = thisProto.__agComponentMetaData;\n      var currentProtoName = thisProto.constructor.name;\n\n      if (metaData && metaData[currentProtoName] && metaData[currentProtoName].querySelectors) {\n        var thisNoType_1 = this_1;\n        metaData[currentProtoName].querySelectors.forEach(function (querySelector) {\n          var resultOfQuery = _this.eGui.querySelector(querySelector.querySelector);\n\n          if (resultOfQuery) {\n            var backingComponent = resultOfQuery.__agComponent;\n\n            if (backingComponent) {\n              thisNoType_1[querySelector.attributeName] = backingComponent;\n            } else {\n              thisNoType_1[querySelector.attributeName] = resultOfQuery;\n            }\n          } else {// put debug msg in here if query selector fails???\n          }\n        });\n      }\n\n      thisProto = Object.getPrototypeOf(thisProto);\n    };\n\n    var this_1 = this;\n\n    while (thisProto != null) {\n      _loop_1();\n    }\n  };\n\n  Component.prototype.addAnnotatedEventListeners = function () {\n    var _this = this;\n\n    this.removeAnnotatedEventListeners();\n\n    if (!this.eGui) {\n      return;\n    }\n\n    var listenerMethods = this.getAgComponentMetaData('listenerMethods');\n\n    if (_.missingOrEmpty(listenerMethods)) {\n      return;\n    }\n\n    if (!this.annotatedEventListeners) {\n      this.annotatedEventListeners = [];\n    }\n\n    listenerMethods.forEach(function (eventListener) {\n      var listener = _this[eventListener.methodName].bind(_this);\n\n      _this.eGui.addEventListener(eventListener.eventName, listener);\n\n      _this.annotatedEventListeners.push({\n        eventName: eventListener.eventName,\n        listener: listener\n      });\n    });\n  };\n\n  Component.prototype.getAgComponentMetaData = function (key) {\n    var res = [];\n    var thisProto = Object.getPrototypeOf(this);\n\n    while (thisProto != null) {\n      var metaData = thisProto.__agComponentMetaData;\n      var currentProtoName = thisProto.constructor.name; // IE does not support Function.prototype.name, so we need to extract\n      // the name using a RegEx\n      // from: https://matt.scharley.me/2012/03/monkey-patch-name-ie.html\n\n      if (currentProtoName === undefined) {\n        var funcNameRegex = /function\\s([^(]{1,})\\(/;\n        var results = funcNameRegex.exec(thisProto.constructor.toString());\n\n        if (results && results.length > 1) {\n          currentProtoName = results[1].trim();\n        }\n      }\n\n      if (metaData && metaData[currentProtoName] && metaData[currentProtoName][key]) {\n        res = res.concat(metaData[currentProtoName][key]);\n      }\n\n      thisProto = Object.getPrototypeOf(thisProto);\n    }\n\n    return res;\n  };\n\n  Component.prototype.removeAnnotatedEventListeners = function () {\n    var _this = this;\n\n    if (!this.annotatedEventListeners || !this.eGui) {\n      return;\n    }\n\n    this.annotatedEventListeners.forEach(function (eventListener) {\n      _this.eGui.removeEventListener(eventListener.eventName, eventListener.listener);\n    });\n    this.annotatedEventListeners = [];\n  };\n\n  Component.prototype.getGui = function () {\n    return this.eGui;\n  };\n\n  Component.prototype.setParentComponent = function (component) {\n    this.parentComponent = component;\n  };\n\n  Component.prototype.getParentComponent = function () {\n    return this.parentComponent;\n  }; // this method is for older code, that wants to provide the gui element,\n  // it is not intended for this to be in ag-Stack\n\n\n  Component.prototype.setGui = function (eGui) {\n    this.eGui = eGui;\n  };\n\n  Component.prototype.queryForHtmlElement = function (cssSelector) {\n    return this.eGui.querySelector(cssSelector);\n  };\n\n  Component.prototype.queryForHtmlInputElement = function (cssSelector) {\n    return this.eGui.querySelector(cssSelector);\n  };\n\n  Component.prototype.appendChild = function (newChild) {\n    if (_.isNodeOrElement(newChild)) {\n      this.eGui.appendChild(newChild);\n    } else {\n      var childComponent = newChild;\n      this.eGui.appendChild(childComponent.getGui());\n      this.childComponents.push(childComponent);\n    }\n  };\n\n  Component.prototype.addFeature = function (feature, context) {\n    this.wireDependentBean(feature, context);\n  };\n\n  Component.prototype.isDisplayed = function () {\n    return this.displayed;\n  };\n\n  Component.prototype.setVisible = function (visible) {\n    if (visible !== this.visible) {\n      this.visible = visible;\n\n      _.setVisible(this.eGui, visible);\n    }\n  };\n\n  Component.prototype.setDisplayed = function (displayed) {\n    if (displayed !== this.displayed) {\n      this.displayed = displayed;\n\n      _.setDisplayed(this.eGui, displayed);\n\n      var event_1 = {\n        type: Component.EVENT_DISPLAYED_CHANGED,\n        visible: this.displayed\n      };\n      this.dispatchEvent(event_1);\n    }\n  };\n\n  Component.prototype.addOrRemoveCssClass = function (className, addOrRemove) {\n    _.addOrRemoveCssClass(this.eGui, className, addOrRemove);\n  };\n\n  Component.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this.childComponents.forEach(function (childComponent) {\n      if (childComponent && childComponent.destroy) {\n        childComponent.destroy();\n      }\n    });\n    this.childComponents.length = 0;\n    this.removeAnnotatedEventListeners();\n  };\n\n  Component.prototype.addGuiEventListener = function (event, listener) {\n    var _this = this;\n\n    this.getGui().addEventListener(event, listener);\n    this.addDestroyFunc(function () {\n      return _this.getGui().removeEventListener(event, listener);\n    });\n  };\n\n  Component.prototype.addCssClass = function (className) {\n    _.addCssClass(this.getGui(), className);\n  };\n\n  Component.prototype.removeCssClass = function (className) {\n    _.removeCssClass(this.getGui(), className);\n  };\n\n  Component.prototype.getAttribute = function (key) {\n    var eGui = this.getGui();\n    return eGui ? eGui.getAttribute(key) : null;\n  };\n\n  Component.prototype.getRefElement = function (refName) {\n    return this.queryForHtmlElement('[ref=\"' + refName + '\"]');\n  };\n\n  Component.EVENT_DISPLAYED_CHANGED = 'displayedChanged';\n\n  __decorate([PreConstruct], Component.prototype, \"createChildComponentsPreConstruct\", null);\n\n  return Component;\n}(BeanStub);\n\nexport { Component };","map":null,"metadata":{},"sourceType":"module"}