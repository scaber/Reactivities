{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\nexports.defaultGetDataState = defaultGetDataState;\nexports.getCommonListProps = getCommonListProps;\nexports.default = reduceToListState;\n\nvar _Filter = require(\"./Filter\");\n\nvar _ = require(\"./_\");\n\nvar _dataHelpers = require(\"./dataHelpers\");\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nvar EMPTY_VALUE = {};\n\nvar returnFalse = function returnFalse() {\n  return false;\n};\n\nfunction defaultGetDataState(data, _ref, lastState) {\n  var groupBy = _ref.groupBy;\n\n  if (lastState === void 0) {\n    lastState = {};\n  }\n\n  if (lastState.data !== data || lastState.groupBy !== groupBy) {\n    if (!groupBy) return {};\n    var keys = [];\n    var groups = (0, _.groupBySortedKeys)(groupBy, data, keys);\n    return {\n      data: data,\n      groupBy: groupBy,\n      groups: groups,\n      sortedKeys: keys,\n      sequentialData: Object.keys(groups).reduce(function (flat, grp) {\n        return flat.concat(groups[grp]);\n      }, [])\n    };\n  }\n\n  return lastState;\n}\n\nvar getStateGetterFromList = function getStateGetterFromList(_ref2) {\n  var l = _ref2.listComponent;\n  return l && l.getDataState;\n};\n\nvar getIsDisabled = function getIsDisabled(disabledProp, valueField) {\n  return !Array.isArray(disabledProp) ? returnFalse : function (item) {\n    return disabledProp.some(function (i) {\n      return (0, _dataHelpers.dataValue)(item, valueField) === (0, _dataHelpers.dataValue)(i, valueField);\n    });\n  };\n};\n\nfunction getCommonListProps(list, accessors, _ref3) {\n  var groupBy = _ref3.groupBy,\n      optionComponent = _ref3.optionComponent,\n      itemComponent = _ref3.itemComponent,\n      groupComponent = _ref3.groupComponent,\n      searchTerm = _ref3.searchTerm,\n      listProps = _ref3.listProps;\n  return _extends({\n    searchTerm: searchTerm,\n    groupBy: groupBy,\n    groupComponent: groupComponent,\n    itemComponent: itemComponent,\n    optionComponent: optionComponent\n  }, listProps, {\n    data: list.data,\n    dataState: list.state,\n    textAccessor: accessors.text,\n    valueAccessor: accessors.value\n  });\n}\n\nfunction reduceToListState(nextListData, prevList, _temp) {\n  var _ref4 = _temp === void 0 ? {} : _temp,\n      nextProps = _ref4.nextProps,\n      getDataState = _ref4.getDataState;\n\n  var disabled = nextProps.disabled,\n      valueField = nextProps.valueField,\n      textField = nextProps.textField;\n  getDataState = getDataState || getStateGetterFromList(nextProps) || defaultGetDataState;\n  var dataState = getDataState(nextListData, nextProps, prevList && prevList.dataState);\n  var data = dataState && dataState.sequentialData || nextListData;\n  var isDisabled = getIsDisabled(disabled, valueField);\n\n  var moveNext = function moveNext(item, word) {\n    return isDisabled(item) || word && !_Filter.presets.startsWith((0, _dataHelpers.dataText)(item, textField).toLowerCase(), word.toLowerCase());\n  };\n\n  var list = {\n    dataState: dataState,\n    isDisabled: isDisabled,\n    first: function first() {\n      return list.next(EMPTY_VALUE);\n    },\n    last: function last() {\n      return list.prevEnabled(data[data.length - 1]);\n    },\n    prev: function prev(item, word) {\n      var nextIdx = Math.max(0, data.indexOf(item)) - 1;\n\n      while (nextIdx > -1 && moveNext(data[nextIdx], word)) {\n        nextIdx--;\n      }\n\n      if (nextIdx >= 0) return data[nextIdx];\n      return isDisabled(item) ? null : item;\n    },\n    next: function next(item, word) {\n      var nextIdx = data.indexOf(item) + 1;\n\n      while (nextIdx < data.length && moveNext(data[nextIdx], word)) {\n        nextIdx++;\n      }\n\n      if (nextIdx < data.length) return data[nextIdx];\n      return isDisabled(item) ? null : item;\n    },\n    prevEnabled: function prevEnabled(item) {\n      return isDisabled(item) ? list.prev(item) : item;\n    },\n    nextEnabled: function nextEnabled(item) {\n      return isDisabled(item) ? list.next(item) : item;\n    }\n  };\n  return list;\n}","map":{"version":3,"sources":["C:/Projects/Reactivities/client-app/node_modules/react-widgets/lib/util/reduceToListState.js"],"names":["exports","__esModule","defaultGetDataState","getCommonListProps","default","reduceToListState","_Filter","require","_","_dataHelpers","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","EMPTY_VALUE","returnFalse","data","_ref","lastState","groupBy","keys","groups","groupBySortedKeys","sortedKeys","sequentialData","reduce","flat","grp","concat","getStateGetterFromList","_ref2","l","listComponent","getDataState","getIsDisabled","disabledProp","valueField","Array","isArray","item","some","dataValue","list","accessors","_ref3","optionComponent","itemComponent","groupComponent","searchTerm","listProps","dataState","state","textAccessor","text","valueAccessor","value","nextListData","prevList","_temp","_ref4","nextProps","disabled","textField","isDisabled","moveNext","word","presets","startsWith","dataText","toLowerCase","first","next","last","prevEnabled","prev","nextIdx","Math","max","indexOf","nextEnabled"],"mappings":"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","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.defaultGetDataState = defaultGetDataState;\nexports.getCommonListProps = getCommonListProps;\nexports.default = reduceToListState;\n\nvar _Filter = require(\"./Filter\");\n\nvar _ = require(\"./_\");\n\nvar _dataHelpers = require(\"./dataHelpers\");\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nvar EMPTY_VALUE = {};\n\nvar returnFalse = function returnFalse() {\n  return false;\n};\n\nfunction defaultGetDataState(data, _ref, lastState) {\n  var groupBy = _ref.groupBy;\n\n  if (lastState === void 0) {\n    lastState = {};\n  }\n\n  if (lastState.data !== data || lastState.groupBy !== groupBy) {\n    if (!groupBy) return {};\n    var keys = [];\n    var groups = (0, _.groupBySortedKeys)(groupBy, data, keys);\n    return {\n      data: data,\n      groupBy: groupBy,\n      groups: groups,\n      sortedKeys: keys,\n      sequentialData: Object.keys(groups).reduce(function (flat, grp) {\n        return flat.concat(groups[grp]);\n      }, [])\n    };\n  }\n\n  return lastState;\n}\n\nvar getStateGetterFromList = function getStateGetterFromList(_ref2) {\n  var l = _ref2.listComponent;\n  return l && l.getDataState;\n};\n\nvar getIsDisabled = function getIsDisabled(disabledProp, valueField) {\n  return !Array.isArray(disabledProp) ? returnFalse : function (item) {\n    return disabledProp.some(function (i) {\n      return (0, _dataHelpers.dataValue)(item, valueField) === (0, _dataHelpers.dataValue)(i, valueField);\n    });\n  };\n};\n\nfunction getCommonListProps(list, accessors, _ref3) {\n  var groupBy = _ref3.groupBy,\n      optionComponent = _ref3.optionComponent,\n      itemComponent = _ref3.itemComponent,\n      groupComponent = _ref3.groupComponent,\n      searchTerm = _ref3.searchTerm,\n      listProps = _ref3.listProps;\n  return _extends({\n    searchTerm: searchTerm,\n    groupBy: groupBy,\n    groupComponent: groupComponent,\n    itemComponent: itemComponent,\n    optionComponent: optionComponent\n  }, listProps, {\n    data: list.data,\n    dataState: list.state,\n    textAccessor: accessors.text,\n    valueAccessor: accessors.value\n  });\n}\n\nfunction reduceToListState(nextListData, prevList, _temp) {\n  var _ref4 = _temp === void 0 ? {} : _temp,\n      nextProps = _ref4.nextProps,\n      getDataState = _ref4.getDataState;\n\n  var disabled = nextProps.disabled,\n      valueField = nextProps.valueField,\n      textField = nextProps.textField;\n  getDataState = getDataState || getStateGetterFromList(nextProps) || defaultGetDataState;\n  var dataState = getDataState(nextListData, nextProps, prevList && prevList.dataState);\n  var data = dataState && dataState.sequentialData || nextListData;\n  var isDisabled = getIsDisabled(disabled, valueField);\n\n  var moveNext = function moveNext(item, word) {\n    return isDisabled(item) || word && !_Filter.presets.startsWith((0, _dataHelpers.dataText)(item, textField).toLowerCase(), word.toLowerCase());\n  };\n\n  var list = {\n    dataState: dataState,\n    isDisabled: isDisabled,\n    first: function first() {\n      return list.next(EMPTY_VALUE);\n    },\n    last: function last() {\n      return list.prevEnabled(data[data.length - 1]);\n    },\n    prev: function prev(item, word) {\n      var nextIdx = Math.max(0, data.indexOf(item)) - 1;\n\n      while (nextIdx > -1 && moveNext(data[nextIdx], word)) {\n        nextIdx--;\n      }\n\n      if (nextIdx >= 0) return data[nextIdx];\n      return isDisabled(item) ? null : item;\n    },\n    next: function next(item, word) {\n      var nextIdx = data.indexOf(item) + 1;\n\n      while (nextIdx < data.length && moveNext(data[nextIdx], word)) {\n        nextIdx++;\n      }\n\n      if (nextIdx < data.length) return data[nextIdx];\n      return isDisabled(item) ? null : item;\n    },\n    prevEnabled: function prevEnabled(item) {\n      return isDisabled(item) ? list.prev(item) : item;\n    },\n    nextEnabled: function nextEnabled(item) {\n      return isDisabled(item) ? list.next(item) : item;\n    }\n  };\n  return list;\n}"]},"metadata":{},"sourceType":"script"}