{"ast":null,"code":"var __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { _, Autowired, Bean } from \"@ag-grid-community/core\";\n\nvar SortStage =\n/** @class */\nfunction () {\n  function SortStage() {}\n\n  SortStage.prototype.execute = function (params) {\n    var sortOptions = this.sortController.getSortForRowController();\n    var sortActive = _.exists(sortOptions) && sortOptions.length > 0;\n    var deltaSort = sortActive && _.exists(params.rowNodeTransactions) // in time we can remove this check, so that delta sort is always\n    // on if transactions are present. it's off for now so that we can\n    // selectively turn it on and test it with some select users before\n    // rolling out to everyone.\n    && this.gridOptionsWrapper.isDeltaSort(); // we only need dirty nodes if doing delta sort\n\n    var dirtyLeafNodes = deltaSort ? this.calculateDirtyNodes(params.rowNodeTransactions) : null;\n    var valueColumns = this.columnController.getValueColumns();\n\n    var noAggregations = _.missingOrEmpty(valueColumns);\n\n    this.sortService.sort(sortOptions, sortActive, deltaSort, dirtyLeafNodes, params.changedPath, noAggregations);\n  };\n\n  SortStage.prototype.calculateDirtyNodes = function (rowNodeTransactions) {\n    var dirtyNodes = {};\n\n    var addNodesFunc = function (rowNodes) {\n      if (rowNodes) {\n        rowNodes.forEach(function (rowNode) {\n          return dirtyNodes[rowNode.id] = true;\n        });\n      }\n    }; // all leaf level nodes in the transaction were impacted\n\n\n    rowNodeTransactions.forEach(function (tran) {\n      addNodesFunc(tran.add);\n      addNodesFunc(tran.update);\n      addNodesFunc(tran.remove);\n    });\n    return dirtyNodes;\n  };\n\n  __decorate([Autowired('gridOptionsWrapper')], SortStage.prototype, \"gridOptionsWrapper\", void 0);\n\n  __decorate([Autowired('sortService')], SortStage.prototype, \"sortService\", void 0);\n\n  __decorate([Autowired('sortController')], SortStage.prototype, \"sortController\", void 0);\n\n  __decorate([Autowired('columnController')], SortStage.prototype, \"columnController\", void 0);\n\n  SortStage = __decorate([Bean('sortStage')], SortStage);\n  return SortStage;\n}();\n\nexport { SortStage };","map":null,"metadata":{},"sourceType":"module"}